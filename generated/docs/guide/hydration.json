{"id":"guide/hydration","title":"Hydration","contents":"\n\n\n<div class=\"github-links\">\n  <a href=\"https://github.com/ng-docs/angular-cn/edit/cn/aio/content/guide/hydration.md?message=docs%3A%20请简述你的修改...\" aria-label=\"提供编辑建议\" title=\"提供编辑建议\"><i class=\"material-icons\" aria-hidden=\"true\" role=\"img\">mode_edit</i></a>\n</div>\n\n\n<div class=\"content\">\n  <h1 id=\"hydration\" translation-result=\"on\">水合（Hydration）<a title=\"Link to this heading\" class=\"header-link\" aria-hidden=\"true\" href=\"guide/hydration#hydration\"><i class=\"material-icons\">link</i></a></h1><h1 translation-origin=\"off\">Hydration<a title=\"Link to this heading\" class=\"header-link\" aria-hidden=\"true\" href=\"guide/hydration#hydration\"><i class=\"material-icons\">link</i></a></h1>\n\n<div class=\"alert is-important\">\n<p translation-result=\"on\">水合（Hydration）特性已经可以供<a href=\"/guide/releases#developer-preview\">开发者预览</a>了。你可以试用它，但是在稳定之前还可能发生变化。</p><p translation-origin=\"off\">The hydration feature is available for <a href=\"/guide/releases#developer-preview\">developer preview</a>. It's ready for you to try, but it might change before it is stable.</p>\n\n</div>\n<h2 id=\"what-is-hydration\" translation-result=\"on\">什么是水合<a title=\"Link to this heading\" class=\"header-link\" aria-hidden=\"true\" href=\"guide/hydration#what-is-hydration\"><i class=\"material-icons\">link</i></a></h2><h2 translation-origin=\"off\">What is hydration<a title=\"Link to this heading\" class=\"header-link\" aria-hidden=\"true\" href=\"guide/hydration#what-is-hydration\"><i class=\"material-icons\">link</i></a></h2>\n\n<p translation-result=\"on\">水合是指在客户端恢复服务端渲染出的应用程序的过程。这包括复用服务端渲染的 DOM 结构、持久化应用程序状态、传输服务端已经获取到的应用程序数据，还有一些其他过程。</p><p translation-origin=\"off\">Hydration is the process that restores the server side rendered application on the client. This includes things like reusing the server rendered DOM structures, persisting the application state, transferring application data that was retrieved already by the server, and other processes.</p>\n\n<h2 id=\"why-is-hydration-important\" translation-result=\"on\">为什么水合很重要？<a title=\"Link to this heading\" class=\"header-link\" aria-hidden=\"true\" href=\"guide/hydration#why-is-hydration-important\"><i class=\"material-icons\">link</i></a></h2><h2 translation-origin=\"off\">Why is hydration important?<a title=\"Link to this heading\" class=\"header-link\" aria-hidden=\"true\" href=\"guide/hydration#why-is-hydration-important\"><i class=\"material-icons\">link</i></a></h2>\n\n<p translation-result=\"on\">水合通过避免重新创建 DOM 节点的额外工作来提高应用程序性能。而 Angular 会试图在运行时将现有的 DOM 元素与应用程序结构相匹配，只在可能的情况下复用 DOM 节点。这能改进性能，可以使用<a href=\"https://web.dev/learn-core-web-vitals/\">核心 Web 体验（CWV）</a>这组统计数据来衡量，例如减少首次输入延迟（<a href=\"https://web.dev/fid/\">FID</a>）和最大内容绘制（<a href=\"https://web.dev/lcp/\">LCP</a>），以及累积布局偏移（<a href=\"https://web.dev/cls/\">CLS</a>）。改善这些数据也会影响诸如 SEO 性能之类的指标。</p><p translation-origin=\"off\">Hydration improves application performance by avoiding extra work to re-create DOM nodes. Instead, Angular tries to match existing DOM elements to the applications structure at runtime and reuses DOM nodes when possible. This results in a performance improvement that can be measured using <a href=\"https://web.dev/learn-core-web-vitals/\">Core Web Vitals (CWV)</a> statistics, such as reducing the First Input Delay (<a href=\"https://web.dev/fid/\">FID</a>) and Largest Contentful Paint (<a href=\"https://web.dev/lcp/\">LCP</a>), as well as Cumulative Layout Shift (<a href=\"https://web.dev/cls/\">CLS</a>). Improving these numbers also affects things like SEO performance.</p>\n\n<p translation-result=\"on\">如果不启用水合，服务端渲染的 Angular 应用程序将销毁并重新渲染应用程序的 DOM，这可能会导致可见的 UI 闪烁。这种重新渲染会对像 <a href=\"https://web.dev/lcp/\">LCP</a> 这样的 <a href=\"https://web.dev/learn-core-web-vitals/\">核心 Web 体验</a>产生负面影响，并导致布局变化。启用水合能让你复用现有的 DOM 并防止闪烁。</p><p translation-origin=\"off\">Without hydration enabled, server side rendered Angular applications will destroy and re-render the application's DOM, which may result in a visible UI flicker. This re-rendering can negatively impact <a href=\"https://web.dev/learn-core-web-vitals/\">Core Web Vitals</a> like <a href=\"https://web.dev/lcp/\">LCP</a> and cause a layout shift. Enabling hydration allows the existing DOM to be re-used and prevents a flicker.</p>\n\n<p><a id=\"how-to-enable\"></a></p>\n<h2 id=\"how-do-you-enable-hydration-in-angular\" translation-result=\"on\">如何在 Angular 中启用水合<a title=\"Link to this heading\" class=\"header-link\" aria-hidden=\"true\" href=\"guide/hydration#how-do-you-enable-hydration-in-angular\"><i class=\"material-icons\">link</i></a></h2><h2 translation-origin=\"off\">How do you enable hydration in Angular<a title=\"Link to this heading\" class=\"header-link\" aria-hidden=\"true\" href=\"guide/hydration#how-do-you-enable-hydration-in-angular\"><i class=\"material-icons\">link</i></a></h2>\n\n<p translation-result=\"on\">在开始水合之前，你必须有一个服务端渲染（SSR）的应用程序。首先按照 <a href=\"/guide/universal\">Angular Univeral 指南</a>启用服务端渲染。一旦你的应用程序使用了 SSR，就可以通过为主要组件或模块从 <code>@angular/platform-browser</code> 导入 <code><a href=\"api/platform-browser/provideClientHydration\" class=\"code-anchor\">provideClientHydration</a></code> 来启用水合。然后，你还要把 <code><a href=\"api/platform-browser/provideClientHydration\" class=\"code-anchor\">provideClientHydration</a></code> 返回的提供者添加到应用程序的引导程序提供者列表中。</p><p translation-origin=\"off\">Before you can get started with hydration, you must have a server side rendered (SSR) application. Follow the <a href=\"/guide/universal\">Angular Universal Guide</a> to enable server side rendering first. Once you have SSR working with your application, you can enable hydration by visiting your main app component or module and importing <code><a href=\"api/platform-browser/provideClientHydration\" class=\"code-anchor\">provideClientHydration</a></code> from <code>@angular/platform-browser</code>. You'll then add that provider to your app's bootstrapping providers list.</p>\n\n<code-example language=\"typescript\">\nimport {\n  <a href=\"api/platform-browser/bootstrapApplication\" class=\"code-anchor\">bootstrapApplication</a>,\n  <a href=\"api/platform-browser/provideClientHydration\" class=\"code-anchor\">provideClientHydration</a>,\n} from '@angular/platform-browser';\n...\n\n<a href=\"api/platform-browser/bootstrapApplication\" class=\"code-anchor\">bootstrapApplication</a>(RootCmp, {\n  providers: [<a href=\"api/platform-browser/provideClientHydration\" class=\"code-anchor\">provideClientHydration</a>()]\n});\n</code-example>\n<p translation-result=\"on\">或者，如果你在使用 NgModules，可以将 <code><a href=\"api/platform-browser/provideClientHydration\" class=\"code-anchor\">provideClientHydration</a></code> 添加到根应用程序模块的提供者列表中。</p><p translation-origin=\"off\">Alternatively if you are using NgModules, you would add <code><a href=\"api/platform-browser/provideClientHydration\" class=\"code-anchor\">provideClientHydration</a></code> to your root app module's provider list.</p>\n\n<code-example language=\"typescript\">\nimport {<a href=\"api/platform-browser/provideClientHydration\" class=\"code-anchor\">provideClientHydration</a>} from '@angular/platform-browser';\nimport {<a href=\"api/core/NgModule\" class=\"code-anchor\">NgModule</a>} from '@angular/core';\n\n@<a href=\"api/core/NgModule\" class=\"code-anchor\">NgModule</a>({\n  declarations: [RootCmp],\n  exports: [RootCmp],\n  bootstrap: [RootCmp],\n  providers: [<a href=\"api/platform-browser/provideClientHydration\" class=\"code-anchor\">provideClientHydration</a>()],\n})\nexport class AppModule {}\n</code-example>\n<div class=\"alert is-helpful\">\n<p translation-result=\"on\"><strong>重要提示</strong>：确保 <code><a href=\"api/platform-browser/provideClientHydration\" class=\"code-anchor\">provideClientHydration</a>()</code> 调用也包含在用于在<strong>服务端</strong>引导应用程序的提供者列表中。在具有默认项目结构的应用程序中（由<code>ng new</code>命令生成）加入对根 <code>AppModule</code> 的调用应该就够了，因为该模块已被服务端模块导入。如果你使用自定义设置，请将 <code><a href=\"api/platform-browser/provideClientHydration\" class=\"code-anchor\">provideClientHydration</a>()</code> 调用添加到服务端启动配置中的提供者列表中。</p><p translation-origin=\"off\"><strong>Important note</strong>: make sure that the <code><a href=\"api/platform-browser/provideClientHydration\" class=\"code-anchor\">provideClientHydration</a>()</code> call is also included into\na set of providers that is used to bootstrap an application on the <strong>server</strong>. In applications with the default project structure (generated by\nthe <code>ng new</code> command), adding a call to the root <code>AppModule</code> should be sufficient, since this module is imported by the server module. If you use a custom setup, add the <code><a href=\"api/platform-browser/provideClientHydration\" class=\"code-anchor\">provideClientHydration</a>()</code> call to the providers list in the server bootstrap configuration.</p>\n\n</div>\n<p translation-result=\"on\">完成这些步骤并启动服务端后，在浏览器中加载你的应用程序。</p><p translation-origin=\"off\">After you've followed these steps and have started up your server, load your application in the browser.</p>\n\n<div class=\"alert is-helpful\">\n<p translation-result=\"on\">在启用水合之前，你可能需要修复直接操纵 DOM 的实例，可以通过切换到 Angular 式的构造或使用 <code>ngSkipHydration</code> 来完成。详见<a href=\"guide/hydration#constraints\">约束条件</a>、<a href=\"guide/hydration#dom-manipulation\">直接 DOM 操作</a>和<a href=\"guide/hydration#ngskiphydration\">如何在水合时跳过特定组件</a>。</p><p translation-origin=\"off\">You will likely need to fix instances of Direct DOM Manipulation before hydration will fully work either by switching to Angular constructs or by using <code>ngSkipHydration</code>. See <a href=\"guide/hydration#constraints\">Constraints</a>, <a href=\"guide/hydration#dom-manipulation\">Direct DOM Manipulation</a>, and <a href=\"guide/hydration#ngskiphydration\">How to skip hydration for particular components</a> for more details.</p>\n\n</div>\n<p translation-result=\"on\">在开发模式下运行应用程序时，你可以通过在浏览器中打开开发者工具并查看控制台来确认已启用水合。你应该会看到一条消息，其中包含与水合相关的统计信息，例如水合的组件数和节点数。注意：Angular 会根据页面上渲染的所有组件计算统计信息，包括那些来自第三方库的组件。</p><p translation-origin=\"off\">While running an application in dev mode, you can confirm hydration is enabled by opening the Developer Tools in your browser and viewing the console. You should see a message that includes hydration-related stats, such as the number of components and nodes hydrated. Note: Angular calculates the stats based on all components rendered on a page, including those that come from third-party libraries.</p>\n\n<p><a id=\"constraints\"></a></p>\n<h2 id=\"constraints\" translation-result=\"on\">约束条件<a title=\"Link to this heading\" class=\"header-link\" aria-hidden=\"true\" href=\"guide/hydration#constraints\"><i class=\"material-icons\">link</i></a></h2><h2 translation-origin=\"off\">Constraints<a title=\"Link to this heading\" class=\"header-link\" aria-hidden=\"true\" href=\"guide/hydration#constraints\"><i class=\"material-icons\">link</i></a></h2>\n\n<p translation-result=\"on\">水合对你的应用程序施加了一些限制，这些限制在没有启用水合的情况下是不存在的。你的应用程序必须在服务端和客户端具有相同的生成的 DOM 结构。水合过程期望 DOM 树在两个地方具有相同的结构。这还包括 Angular 在服务端渲染期间生成的空白和注释节点。这些空白和注释节点必须出现在服务端渲染过程生成的 HTML 中。</p><p translation-origin=\"off\">Hydration imposes a few constraints on your application that are not present without hydration enabled. Your application must have the same generated DOM structure on both the server and the client. The process of hydration expects the DOM tree to have the same structure in both places. This also includes whitespaces and comment nodes that Angular produces during the rendering on the server. Those whitespaces and nodes must be present in the HTML generated by the server-side rendering process.</p>\n\n<div class=\"alert is-important\">\n<p translation-result=\"on\">服务端渲染操作生成的 HTML 在服务端和客户端之间<strong>不能</strong>有任何区别。</p><p translation-origin=\"off\">The HTML produced by the server side rendering operation <strong>must not</strong> be altered between the server and the client.</p>\n\n</div>\n<p translation-result=\"on\">如果服务端和客户端的 DOM 树结构不匹配，当水合过程试图将预期的内容与 DOM 中实际存在的内容相匹配时就会遇到问题。使用原生 DOM API 进行直接 DOM 操作的组件是最常见的罪魁祸首。</p><p translation-origin=\"off\">If there is a mismatch between server and client DOM tree structures, the hydration process will encounter problems attempting to match up what was expected to what is actually present in the DOM. Components that do direct DOM manipulation using native DOM APIs are the most common culprit.</p>\n\n<p><a id=\"dom-manipulation\"></a></p>\n<h3 id=\"direct-dom-manipulation\" translation-result=\"on\">直接 DOM 操作<a title=\"Link to this heading\" class=\"header-link\" aria-hidden=\"true\" href=\"guide/hydration#direct-dom-manipulation\"><i class=\"material-icons\">link</i></a></h3><h3 translation-origin=\"off\">Direct DOM Manipulation<a title=\"Link to this heading\" class=\"header-link\" aria-hidden=\"true\" href=\"guide/hydration#direct-dom-manipulation\"><i class=\"material-icons\">link</i></a></h3>\n\n<p translation-result=\"on\">如果你有使用原生 DOM API 操作 DOM 的组件，水合过程将遇到错误。DOM 操作出问题的具体情况包括访问 <code>document</code> 、查询特定元素以及使用 <code>appendChild</code> 注入其他节点等。分离 DOM 节点并将它们移动到其他位置也会导致错误。</p><p translation-origin=\"off\">If you have components that manipulate the DOM using native DOM APIs, the hydration process will encounter errors. Specific cases where DOM manipulation is a problem are situations like accessing the <code>document</code>, querying for specific elements, and injecting additional nodes using <code>appendChild</code>. Detaching DOM nodes and moving them to other locations will also result in errors.</p>\n\n<p translation-result=\"on\">这是因为 Angular 不了解这些 DOM 变化，并且无法在水合过程中解决它们。Angular 本来期望某种结构，但在尝试水合时遇到了另一种结构。这种差异将导致水合失败并引发 DOM 不匹配错误（<a href=\"guide/hydration#errors\">见下文</a>）。</p><p translation-origin=\"off\">This is because Angular is unaware of these DOM changes and cannot resolve them during the hydration process. Angular will expect a certain structure, but it will encounter a different structure when attempting to hydrate. This mismatch will result in hydration failure and throw a DOM mismatch error (<a href=\"guide/hydration#errors\">see below</a>).</p>\n\n<p translation-result=\"on\">最好重构你的组件以避免此类 DOM 操作。如果可以，请尝试使用 Angular API 来完成这项工作。如果你无法重构此行为，请使用 <code>ngSkipHydration</code> 属性（<a href=\"guide/hydration#ngskiphydration\">如下所述</a>），直到你可以把它重构为对水合友好的解决方案。</p><p translation-origin=\"off\">It is best to refactor your component to avoid this sort of DOM manipulation. Try to use Angular APIs to do this work, if you can. If you cannot refactor this behavior, use the <code>ngSkipHydration</code> attribute (<a href=\"guide/hydration#ngskiphydration\">described below</a>) until you can refactor into a hydration friendly solution.</p>\n\n<h3 id=\"valid-html-structure\" translation-result=\"on\">有效的 HTML 结构<a title=\"Link to this heading\" class=\"header-link\" aria-hidden=\"true\" href=\"guide/hydration#valid-html-structure\"><i class=\"material-icons\">link</i></a></h3><h3 translation-origin=\"off\">Valid HTML structure<a title=\"Link to this heading\" class=\"header-link\" aria-hidden=\"true\" href=\"guide/hydration#valid-html-structure\"><i class=\"material-icons\">link</i></a></h3>\n\n<p translation-result=\"on\">在某些情况下，如果你的组件模板没有有效的 HTML 结构，可能会导致在水合期间出现 DOM 不匹配错误。</p><p translation-origin=\"off\">There are a few cases where if you have a component template that does not have valid HTML structure, this could result in a DOM mismatch error during hydration.</p>\n\n<p translation-result=\"on\">例如，以下是此问题的一些最常见案例。</p><p translation-origin=\"off\">As an example, here are some of the most common cases of this issue.</p>\n\n<ul>\n<li>\n<p translation-result=\"on\"><code>&lt;table&gt;</code> 标签中没有 <code>&lt;tbody&gt;</code></p><p translation-origin=\"off\"><code>&lt;table&gt;</code> without a <code>&lt;tbody&gt;</code></p>\n\n</li>\n<li>\n<p translation-result=\"on\"><code>&lt;div&gt;</code>标签 位于 <code>&lt;p&gt;</code> 中</p><p translation-origin=\"off\"><code>&lt;div&gt;</code> inside a <code>&lt;p&gt;</code></p>\n\n</li>\n<li>\n<p translation-result=\"on\"><code>&lt;a&gt;</code>标签 位于 <code>&lt;h1&gt;</code> 中</p><p translation-origin=\"off\"><code>&lt;a&gt;</code> inside an <code>&lt;h1&gt;</code></p>\n\n</li>\n<li>\n<p translation-result=\"on\"><code>&lt;a&gt;</code> 标签位于另一个 <code>&lt;a&gt;</code> 中</p><p translation-origin=\"off\"><code>&lt;a&gt;</code> inside another <code>&lt;a&gt;</code></p>\n\n</li>\n</ul>\n<p translation-result=\"on\">如果你不确定你的 HTML 是否有效，可以使用<a href=\"https://validator.w3.org/\">语法验证器</a>来检查它。</p><p translation-origin=\"off\">If you are uncertain about whether your HTML is valid, you can use a <a href=\"https://validator.w3.org/\">syntax validator</a> to check it.</p>\n\n<p><a id=\"preserve-whitespaces\"></a></p>\n<h3 id=\"preserve-whitespaces-configuration\" translation-result=\"on\">保留空白字符配置<a title=\"Link to this heading\" class=\"header-link\" aria-hidden=\"true\" href=\"guide/hydration#preserve-whitespaces-configuration\"><i class=\"material-icons\">link</i></a></h3><h3 translation-origin=\"off\">Preserve Whitespaces Configuration<a title=\"Link to this heading\" class=\"header-link\" aria-hidden=\"true\" href=\"guide/hydration#preserve-whitespaces-configuration\"><i class=\"material-icons\">link</i></a></h3>\n\n<p translation-result=\"on\">使用水合功能时，我们建议对 <code>preserveWhitespaces</code> 使用默认设置 <code>false</code>。如果你的 tsconfig 中没有进行此设置，则该值将为 <code>false</code> 而无需更改。如果你选择通过将 <code>preserveWhitespaces: true</code> 添加到你的 tsconfig 中来启用保留空格，就可能会遇到水合问题。这在目前还不是一个受到完全支持的配置。</p><p translation-origin=\"off\">When using the hydration feature, we recommend using the default setting of <code>false</code> for <code>preserveWhitespaces</code>. If this setting is not in your tsconfig, the value will be <code>false</code> and no changes are required. If you choose to enable preserving whitespaces by adding <code>preserveWhitespaces: true</code> to your tsconfig, it is possible you may encounter issues with hydration. This is not yet a fully supported configuration.</p>\n\n<div class=\"alert is-helpful\">\n<p translation-result=\"on\">请确保在服务器端和浏览器端的构建中，<code>tsconfig.server.json</code> 和 <code>tsconfig.app.json</code> 文件中设置的这个选项是<strong>一致的</strong>。如果不一致就会导致水合失败。</p><p translation-origin=\"off\">Make sure that this setting is set <strong>consistently</strong> in <code>tsconfig.server.json</code> for your server and <code>tsconfig.app.json</code> for your browser builds. A mismatched value will cause hydration to break.</p>\n\n<p translation-result=\"on\">如果你选择在 <code>tsconfig</code> 中设置此选项，我们建议仅在 <code>tsconfig.app.json</code> 中设置它，因为默认情况下 <code>tsconfig.server.json</code> 会从 <code>tsconfig.app.json</code> 中继承此选项。</p><p translation-origin=\"off\">If you choose to set this setting in your tsconfig, we recommend to set it only in <code>tsconfig.app.json</code> which by default the <code>tsconfig.server.json</code> will inherit it from.</p>\n\n</div>\n<h3 id=\"custom-or-noop-zonejs-are-not-yet-supported\" translation-result=\"on\">尚不支持自定义或 Noop Zone.js<a title=\"Link to this heading\" class=\"header-link\" aria-hidden=\"true\" href=\"guide/hydration#custom-or-noop-zonejs-are-not-yet-supported\"><i class=\"material-icons\">link</i></a></h3><h3 translation-origin=\"off\">Custom or Noop Zone.js are not yet supported<a title=\"Link to this heading\" class=\"header-link\" aria-hidden=\"true\" href=\"guide/hydration#custom-or-noop-zonejs-are-not-yet-supported\"><i class=\"material-icons\">link</i></a></h3>\n\n<p translation-result=\"on\">水合要依赖于来自 Zone.js 的信号来确定应用程序何时变得稳定，以便 Angular 可以在服务端上启动序列化过程或在客户端启动水合后进行清理工作（以删除无主的 DOM 节点）。</p><p translation-origin=\"off\">Hydration relies on a signal from Zone.js when it becomes stable inside an application, so that Angular can start the serialization process on the server or post-hydration cleanup on the client to remove DOM nodes that remained unclaimed.</p>\n\n<p translation-result=\"on\">提供自定义或 “noop” Zone.js 实现可能会导致“稳定”事件发生在不同的时间点，从而过早或过晚触发序列化或清理。这还不是已受完全支持的配置，你可能需要在自定义 Zone.js 实现中调整 <code>onStable</code> 事件的时间。</p><p translation-origin=\"off\">Providing a custom or a \"noop\" Zone.js implementation may lead to a different timing of the \"stable\" event, thus triggering the serialization or the cleanup too early or too late. This is not yet a fully supported configuration and you may need to adjust the timing of the <code>onStable</code> event in the custom Zone.js implementation.</p>\n\n<p><a id=\"errors\"></a></p>\n<h2 id=\"errors\" translation-result=\"on\">错误<a title=\"Link to this heading\" class=\"header-link\" aria-hidden=\"true\" href=\"guide/hydration#errors\"><i class=\"material-icons\">link</i></a></h2><h2 translation-origin=\"off\">Errors<a title=\"Link to this heading\" class=\"header-link\" aria-hidden=\"true\" href=\"guide/hydration#errors\"><i class=\"material-icons\">link</i></a></h2>\n\n<p translation-result=\"on\">你可能会遇到多种与水合相关的错误，从节点不匹配，到在无效宿主节点上使用 <code>ngSkipHydration</code> 等情况。可能发生的最常见错误情况是由于使用了原生 API 直接进行 DOM 操作导致水合无法在客户端上找到或匹配上服务端渲染的预期 DOM 树结构。另一种情况已在前面有关有效 HTML 结构的部分中提到过。因此，请确保你模板中的 HTML 使用了有效结构，这样就可以避免这种错误情况。</p><p translation-origin=\"off\">There are several hydration related errors you may encounter ranging from node mismatches to cases when the <code>ngSkipHydration</code> was used on an invalid host node. The most common error case that may occur is due to direct DOM manipulation using native APIs that results in hydration being unable to find or match the expected DOM tree structure on the client that was rendered by the server. The other case you may encounter this type of error was mentioned in the prior section on Valid HTML structures. So, make sure the HTML in your templates are using valid structure, and you'll avoid that error case.</p>\n\n<p translation-result=\"on\">有关水合相关错误的完整参考，请访问<a href=\"/errors\">错误参考指南</a>。</p><p translation-origin=\"off\">For a full reference on hydration related errors, visit the <a href=\"/errors\">Errors Reference Guide</a>.</p>\n\n<p><a id=\"ngskiphydration\"></a></p>\n<h2 id=\"how-to-skip-hydration-for-particular-components\" translation-result=\"on\">如何跳过特定组件的水合<a title=\"Link to this heading\" class=\"header-link\" aria-hidden=\"true\" href=\"guide/hydration#how-to-skip-hydration-for-particular-components\"><i class=\"material-icons\">link</i></a></h2><h2 translation-origin=\"off\">How to skip hydration for particular components<a title=\"Link to this heading\" class=\"header-link\" aria-hidden=\"true\" href=\"guide/hydration#how-to-skip-hydration-for-particular-components\"><i class=\"material-icons\">link</i></a></h2>\n\n<p translation-result=\"on\">由于上述某些问题（例如直接操作 DOM），某些组件可能在启用水合的情况下无法正常工作。作为一种变通方法，你可以将 <code>ngSkipHydration</code> 属性添加到组件的标签中，以跳过对整个组件进行水合处理。</p><p translation-origin=\"off\">Some components may not work properly with hydration enabled due to some of the aforementioned issues, like direct DOM manipulation. As a workaround, you can add the <code>ngSkipHydration</code> attribute to a component's tag in order to skip hydrating the entire component.</p>\n\n<code-example language=\"html\">\n&lt;example-cmp ngSkipHydration /&gt;\n</code-example>\n<p translation-result=\"on\">或者，你可以在宿主绑定中使用 <code>ngSkipHydration</code>。</p><p translation-origin=\"off\">Alternatively you can set <code>ngSkipHydration</code> as a host binding.</p>\n\n<code-example language=\"typescript\">\n@<a href=\"api/core/Component\" class=\"code-anchor\">Component</a>({\n  ...\n  host: {ngSkipHydration: 'true'},\n})\nclass ExampleCmp {}\n</code-example>\n<p translation-result=\"on\"><code>ngSkipHydration</code> 属性将强制 Angular 跳过对整个组件及其子组件的水合。使用此属性意味着该组件的行为就像未启用水合一样，这意味着它将自行销毁并重新渲染。</p><p translation-origin=\"off\">The <code>ngSkipHydration</code> attribute will force Angular to skip hydrating the entire component and its children. Using this attribute means that the component will behave as if hydration is not enabled, meaning it will destroy and re-render itself.</p>\n\n<div class=\"alert is-helpful\">\n<p translation-result=\"on\">这将解决渲染问题，但也意味着对于此组件（及其子组件），你将无法从水合中受益。你应该尽量调整组件的实现以避免破坏水合的模式（即直接 DOM 操作），以便能删除跳过水合的注释。</p><p translation-origin=\"off\">This will fix rendering issues, but it means that for this component (and its children), you don't get the benefits of hydration. You will need to adjust your component's implementation to avoid hydration-breaking patterns (i.e. Direct DOM Manipulation) to be able to remove the skip hydration annotation.</p>\n\n</div>\n<p translation-result=\"on\"><code>ngSkipHydration</code> 属性只能在组件的宿主节点上使用。如果将此属性添加到其他节点，Angular 就会抛出错误。</p><p translation-origin=\"off\">The <code>ngSkipHydration</code> attribute can only be used on component host nodes. Angular throws an error if this attribute is added to other nodes.</p>\n\n<p translation-result=\"on\">请记住，将 <code>ngSkipHydration</code> 属性添加到根应用程序组件将有效地禁用对整个应用程序的水合。因此使用此属性时要小心谨慎，它只能作为最后的解决方案。那些破坏水合的组件应被视为需要修复的错误。</p><p translation-origin=\"off\">Keep in mind that adding the <code>ngSkipHydration</code> attribute to your root application component would effectively disable hydration for your entire application. Be careful and thoughtful about using this attribute. It is intended as a last resort workaround. Components that break hydration should be considered bugs that need to be fixed.</p>\n\n<p><a id=\"i18n\"></a></p>\n<h2 id=\"i18n\">I18N<a title=\"Link to this heading\" class=\"header-link\" aria-hidden=\"true\" href=\"guide/hydration#i18n\"><i class=\"material-icons\">link</i></a></h2>\n<p translation-result=\"on\">我们还不支持水合的国际化，但很快就会支持。目前，Angular 会跳过对使用了 i18n 块的组件的水合，有效地从头开始重新渲染这些组件。</p><p translation-origin=\"off\">We don't yet support internationalization with hydration, but support is coming.\nCurrently, Angular would skip hydration for components that use i18n blocks, effectively\nre-rendering those components from scratch.</p>\n\n<h2 id=\"third-party-libraries-with-dom-manipulation\" translation-result=\"on\">具有 DOM 操作的第三方库<a title=\"Link to this heading\" class=\"header-link\" aria-hidden=\"true\" href=\"guide/hydration#third-party-libraries-with-dom-manipulation\"><i class=\"material-icons\">link</i></a></h2><h2 translation-origin=\"off\">Third Party Libraries with DOM Manipulation<a title=\"Link to this heading\" class=\"header-link\" aria-hidden=\"true\" href=\"guide/hydration#third-party-libraries-with-dom-manipulation\"><i class=\"material-icons\">link</i></a></h2>\n\n<p translation-result=\"on\">有许多依赖于 DOM 操作才能渲染的第三方库。D3 图表就是典型。这些库在没有水合的情况下能正常工作，但在启用水合时可能会导致 DOM 不匹配错误。现在，如果你在使用这些库之一时遇到了 DOM 不匹配的错误，可以将 <code>ngSkipHydration</code> 属性添加到使用该库渲染的组件。</p><p translation-origin=\"off\">There are a number of third party libraries that depend on DOM manipulation to be able to render. D3 charts is a prime example. These libraries worked without hydration, but they may cause DOM mismatch errors when hydration is enabled. For now, if you encounter DOM mismatch errors using one of these libraries, you can add the <code>ngSkipHydration</code> attribute to the component that renders using that library.</p>\n\n\n  \n</div>\n\n\n<!-- links to this doc:\n - errors/NG0500\n - errors/NG0503\n - errors/NG0504\n - errors/NG0505\n - errors/NG0912\n - errors/NG5000\n - guide/angular-compiler-options\n - guide/roadmap\n - guide/universal\n-->\n<!-- links from this doc:\n - /errors\n - /guide/releases#developer-preview\n - /guide/universal\n - api/core/Component\n - api/core/NgModule\n - api/platform-browser/bootstrapApplication\n - api/platform-browser/provideClientHydration\n - guide/hydration#constraints\n - guide/hydration#custom-or-noop-zonejs-are-not-yet-supported\n - guide/hydration#direct-dom-manipulation\n - guide/hydration#dom-manipulation\n - guide/hydration#errors\n - guide/hydration#how-do-you-enable-hydration-in-angular\n - guide/hydration#how-to-skip-hydration-for-particular-components\n - guide/hydration#hydration\n - guide/hydration#i18n\n - guide/hydration#ngskiphydration\n - guide/hydration#preserve-whitespaces-configuration\n - guide/hydration#third-party-libraries-with-dom-manipulation\n - guide/hydration#valid-html-structure\n - guide/hydration#what-is-hydration\n - guide/hydration#why-is-hydration-important\n - guide/hydration#为什么水合很重要\n - guide/hydration#什么是水合\n - guide/hydration#保留空白字符配置\n - guide/hydration#具有-dom-操作的第三方库\n - guide/hydration#如何在-angular-中启用水合\n - guide/hydration#如何跳过特定组件的水合\n - guide/hydration#尚不支持自定义或-noop-zonejs\n - guide/hydration#有效的-html-结构\n - guide/hydration#水合hydration\n - guide/hydration#直接-dom-操作\n - guide/hydration#约束条件\n - guide/hydration#错误\n - https://github.com/ng-docs/angular-cn/edit/cn/aio/content/guide/hydration.md?message=docs%3A%20请简述你的修改...\n - https://validator.w3.org/\n - https://web.dev/cls/\n - https://web.dev/fid/\n - https://web.dev/lcp/\n - https://web.dev/learn-core-web-vitals/\n-->"}